function output = GLQuad(f,a,b,M)
    output = 0;
    [nodes,weights] = GLnodesweights(M);
    for i = 1:M
        output = output + weights(i)*f(((b-a)/2)*nodes(i)+(b+a)/2);
    end
    output = output*(b-a)/2;
end

function [nodes,weights] = GLnodesweights(M)
if M == 2
    nodes = [-1/sqrt(3), 1/sqrt(3)];
    weights = [1, 1];
elseif M == 3
    nodes = [-sqrt(3/5), 0, sqrt(3/5)];
    weights = [5/9, 8/9, 5/9];
elseif M == 4
    nodes = [-0.861136311594053, -0.339981043584856, 0.339981043584856, 0.861136311594053];
    weights = [0.347854845137454, 0.652145154862546, 0.652145154862546, 0.347854845137454];
elseif M == 5
    nodes = [-0.906179845938664, -0.538469310105683, 0, 0.538469310105683, 0.906179845938664];
    weights = [0.236926885056189, 0.478628670499366, 0.568888888888889, 0.478628670499366, 0.236926885056189];
elseif M == 6
    nodes = [-0.932469514203152, -0.661209386466265, -0.238619186083197, 0.238619186083197, 0.661209386466265, 0.932469514203152];
    weights = [0.171324492379170, 0.360761573048139, 0.4679139345726910, 0.4679139345726910, 0.360761573048139, 0.171324492379170];
elseif M == 7
    nodes = [-0.949107912342759, -0.741531185599394, -0.405845151377397, 0, 0.405845151377397, 0.741531185599394, 0.949107912342759];
    weights = [0.129484966168870, 0.279705391489277, 0.3818300505051189, 0.4179591836734694, 0.3818300505051189, 0.279705391489277, 0.129484966168870];
end
end